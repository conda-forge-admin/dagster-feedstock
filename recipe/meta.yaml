{% set version = "1.3.3" %}

# this appears to be the pattern at present, but may not hold in the future
{% set lib_version = "0.19." ~ version.split(".")[-1] %}

# this should increase by single increments, but is used below
{% set build_number = 0 %}

# during some re-renders, grpcio_epoch will not be set
{% if grpcio_epoch is not defined %}
  {% set grpcio_epoch = '10' %}
{% endif %}

# handle some python-specific runtime deps... only build addons on 3.10 for now
# TODO; reconsider splitting (usually requires building several packages twice)
{% if grpcio_epoch == '11' %}
  {% set build_plugins = false %}
  {% set py_spec = "python >=3.11" %}
  {% set grpcio_spec = "grpcio >=1.44.0" %}
  {% set epoch_build_number = 2 * build_number %}
{% else %}
  # only one noarch build should do all the plugins
  {% set build_plugins = true %}
  {% set py_spec = "python >=3.7,<3.11" %}
  {% set grpcio_spec = "grpcio >=1.44.0,<1.48.0" %}
  {% set epoch_build_number = 1 + (2 * build_number) %}
{% endif %}

package:
  name: dagster-meta
  version: {{ version }}

source:
  # uses main version
  - folder: dagster
    url: https://pypi.io/packages/source/d/dagster/dagster-{{ version }}.tar.gz
    sha256: 0436000495209683afd1c9dfa526bb2022c4fee76f30530815b6592dbe5610eb

  {% if build_plugins %}
  - folder: dagit
    url: https://pypi.io/packages/source/d/dagit/dagit-{{ version }}.tar.gz
    sha256: c03ae63358d6f7b5909654ee53ea5c874852a4dfbc30a1dd5caab7a9fb6e1cf2

  - folder: dagster-graphql
    url: https://pypi.io/packages/source/d/dagster-graphql/dagster-graphql-{{ version }}.tar.gz
    sha256: f63676cf4d38b2c2ac632ef01f8fdc07e28054bd7bfd699e5fe9eaa79bec5f10

  - folder: dagster-airflow
    url: https://pypi.io/packages/source/d/dagster-airflow/dagster-airflow-{{ version }}.tar.gz
    sha256: e4fe9e0357c9a0a0b139df9d7c7ee458ddb5df828f9d01b9f7684a3a9be1b9dd

  # uses lib version
  - folder: dagster-airbyte
    url: https://pypi.io/packages/source/d/dagster-airbyte/dagster-airbyte-{{ lib_version }}.tar.gz
    sha256: 6ff1f4ade64f1f4c7f15dced4b0395fd18df3d9ab907fee9c75cde0589d92cda

  - folder: dagster-aws
    url: https://pypi.io/packages/source/d/dagster-aws/dagster-aws-{{ lib_version }}.tar.gz
    sha256: 8933305ac5e2c62f1acc3eb7fce48f1a00ce3bd7d2f010b91557fbfbffb062dc

  - folder: dagster-celery
    url: https://pypi.io/packages/source/d/dagster-celery/dagster-celery-{{ lib_version }}.tar.gz
    sha256: b153792d2448df0f7e93c08c05948f77d603842c764f4ea8ff7cd1e2fa496832

  - folder: dagster-celery-docker
    url: https://pypi.io/packages/source/d/dagster-celery-docker/dagster-celery-docker-{{ lib_version }}.tar.gz
    sha256: e3f5e2af92ff7b0b75b34d1c39349c879d907e5393e2302be7a4f886a664629e

  - folder: dagster-celery-k8s
    url: https://pypi.io/packages/source/d/dagster-celery-k8s/dagster-celery-k8s-{{ lib_version }}.tar.gz
    sha256: c6795c710e02ef2547ec5bdeec97e0930853b3649b7cef1c9624299867b19879

  - folder: dagster-census
    url: https://pypi.io/packages/source/d/dagster-census/dagster-census-{{ lib_version }}.tar.gz
    sha256: 5bc3f9e053af936e7f1ff1d9272efa439dbddc9e1db0b15696d65465d9a39fea

  - folder: dagster-dask
    url: https://pypi.io/packages/source/d/dagster-dask/dagster-dask-{{ lib_version }}.tar.gz
    sha256: 6308f59e0e2895ded14f7022f67a0f7266c638c1fbf750b350257141e4dfe78d

  - folder: dagster-datadog
    url: https://pypi.io/packages/source/d/dagster-datadog/dagster-datadog-{{ lib_version }}.tar.gz
    sha256: e667e4d5d02e0f2444b0cb7c8259ec8bafa3a9b4ed19ce439d6bed945813bdae

  - folder: dagster-dbt
    url: https://pypi.io/packages/source/d/dagster-dbt/dagster-dbt-{{ lib_version }}.tar.gz
    sha256: 7e2092e23a33cd12e84eb643156097d5378c4bd4120e517ff6460c4bee3b8fb5

  - folder: dagster-docker
    url: https://pypi.io/packages/source/d/dagster-docker/dagster-docker-{{ lib_version }}.tar.gz
    sha256: fbcd78724d0888bb8101a4edea6b09121bc7ab165345a1b0a44478f23219cdc5

  - folder: dagster-duckdb
    url: https://pypi.io/packages/source/d/dagster-duckdb/dagster-duckdb-{{ lib_version }}.tar.gz
    sha256: 63751c94155ac7564869e1734461e72d2257cd2e9fdff622a449d2859ace5fe0

  - folder: dagster-duckdb-pandas
    url: https://pypi.io/packages/source/d/dagster-duckdb-pandas/dagster-duckdb-pandas-{{ lib_version }}.tar.gz
    sha256: 42c600cba40277276ceae3b9d72d50774e228c1420520317f6233d4579a4fb6d

  - folder: dagster-duckdb-polars
    url: https://pypi.io/packages/source/d/dagster-duckdb-polars/dagster-duckdb-polars-{{ lib_version }}.tar.gz
    sha256: 8cd80424274931d8ae456d74fa2933f6fe2c842580fd08dd8f042db2471e7adb

  - folder: dagster-duckdb-pyspark
    url: https://pypi.io/packages/source/d/dagster-duckdb-pyspark/dagster-duckdb-pyspark-{{ lib_version }}.tar.gz
    sha256: 08e5c727852171fbf5f7318d8e0508cb5e430d5a69f1f79a2a840a60ea62b09a

  - folder: dagster-fivetran
    url: https://pypi.io/packages/source/d/dagster-fivetran/dagster-fivetran-{{ lib_version }}.tar.gz
    sha256: 007ab9c87f2bb28f340b54a3bb76457cc3d99ecdb8e12dfb39836f345ef236f6

  - folder: dagster-gcp
    url: https://pypi.io/packages/source/d/dagster-gcp/dagster-gcp-{{ lib_version }}.tar.gz
    sha256: f1de63b9182bfff3483863ad688fd49a6c8e02771e242b142a858c3a545e10ff

  - folder: dagster-gcp-pandas
    url: https://pypi.io/packages/source/d/dagster-gcp-pandas/dagster-gcp-pandas-{{ lib_version }}.tar.gz
    sha256: 587a9aab64b35f162042aca85c74a0875eb995a74a7bd1c98e4898a3b0572c47

  - folder: dagster-gcp-pyspark
    url: https://pypi.io/packages/source/d/dagster-gcp-pyspark/dagster_gcp_pyspark-{{ lib_version }}.tar.gz
    sha256: 98a4527e4c764c1d0004766a24a970603f2eea36eb88fbdb9cb55fdaf4e18df3

  - folder: dagster-ge
    url: https://pypi.io/packages/source/d/dagster-ge/dagster-ge-{{ lib_version }}.tar.gz
    sha256: 55a344ef2fe9bbcf754e04ec28062941096523467aa83847772413629119c5ee

  - folder: dagster-github
    url: https://pypi.io/packages/source/d/dagster-github/dagster-github-{{ lib_version }}.tar.gz
    sha256: c23370b490d41a3d9314b8bdf7e6989adb7560142bb5301aed23cb226d242405

  - folder: dagster-k8s
    url: https://pypi.io/packages/source/d/dagster-k8s/dagster-k8s-{{ lib_version }}.tar.gz
    sha256: 35286f8062e71d93b15da3f5c68aef6738b838f0a4f51f0a39396c7a8568b1f4

  - folder: dagster-managed-elements
    url: https://pypi.io/packages/source/d/dagster-managed-elements/dagster-managed-elements-{{ lib_version }}.tar.gz
    sha256: af190127b8e25e89e55681349d5550b6347091d05529f92282d90aad75e42d3f

  - folder: dagster-mlflow
    url: https://pypi.io/packages/source/d/dagster-mlflow/dagster-mlflow-{{ lib_version }}.tar.gz
    sha256: cf6bcdf70b49278bc7d1f2e819afa707ef984c25714a807c3987d097285d7eb3

  - folder: dagster-msteams
    url: https://pypi.io/packages/source/d/dagster-msteams/dagster-msteams-{{ lib_version }}.tar.gz
    sha256: a412f168857be52fd3057397e2e85573d364e906b5469152af2702a62ea9d47f

  - folder: dagster-mysql
    url: https://pypi.io/packages/source/d/dagster-mysql/dagster-mysql-{{ lib_version }}.tar.gz
    sha256: ada1925bbf226103118bceaf6315ebfe1d7544adb906d2b3674bb388bafa10f7

  - folder: dagster-pagerduty
    url: https://pypi.io/packages/source/d/dagster-pagerduty/dagster-pagerduty-{{ lib_version }}.tar.gz
    sha256: 42169610985d9a5b81f20b3ea1bfc71e5bd1e281d7dd2f7014d5e6966064ee42

  - folder: dagster-pandas
    url: https://pypi.io/packages/source/d/dagster-pandas/dagster-pandas-{{ lib_version }}.tar.gz
    sha256: ddef6bf4fc375897d40eacaf22949678f1dd574531f091c98ced5670ff4200b6

  - folder: dagster-pandera
    url: https://pypi.io/packages/source/d/dagster-pandera/dagster-pandera-{{ lib_version }}.tar.gz
    sha256: 7aa7914decbe2c91af4bc3c0dda4e8d72051642178a680fdd2ac4e56e484f475

  - folder: dagster-papertrail
    url: https://pypi.io/packages/source/d/dagster-papertrail/dagster-papertrail-{{ lib_version }}.tar.gz
    sha256: 6cc8f68e113a2f4b913466aa00322e8f31e0d9c70a06269aa0e3f7435172e677

  - folder: dagster-postgres
    url: https://pypi.io/packages/source/d/dagster-postgres/dagster-postgres-{{ lib_version }}.tar.gz
    sha256: ea07d29a2e6b41caadedb15c521f290c0682de74ca3508e56d0eb701b147eff1

  - folder: dagster-prometheus
    url: https://pypi.io/packages/source/d/dagster-prometheus/dagster-prometheus-{{ lib_version }}.tar.gz
    sha256: f63fee4f781a545d23b7b221bcc930a5eed7d46e7f25d9ee4a5cbfc7fd0ed508

  - folder: dagster-pyspark
    url: https://pypi.io/packages/source/d/dagster-pyspark/dagster-pyspark-{{ lib_version }}.tar.gz
    sha256: bee36242dd8f7269a853290e7977b9d9c1263adbf0eff6fc10169af33f6f2e7e

  - folder: dagster-shell
    url: https://pypi.io/packages/source/d/dagster-shell/dagster-shell-{{ lib_version }}.tar.gz
    sha256: 5216ce28bb13ce893d6e19aee6c99412b92d080f22299da826047220e7631977

  - folder: dagster-slack
    url: https://pypi.io/packages/source/d/dagster-slack/dagster-slack-{{ lib_version }}.tar.gz
    sha256: fc1e5831b9af0154ec3b92e1e2f0490fba0ccf56fc9a0290424875386f9bb3c0

  - folder: dagster-snowflake
    url: https://pypi.io/packages/source/d/dagster-snowflake/dagster-snowflake-{{ lib_version }}.tar.gz
    sha256: c109b06caf354d817577d47a12ddea5a56593b803d528e562ea4dbafec427f21

  - folder: dagster-snowflake-pandas
    url: https://pypi.io/packages/source/d/dagster-snowflake-pandas/dagster-snowflake-pandas-{{ lib_version }}.tar.gz
    sha256: 204200b30b2502283eb52708aeaad2766130b6fdd76e9bfb16625bcf682669f6

  - folder: dagster-snowflake-pyspark
    url: https://pypi.io/packages/source/d/dagster-snowflake-pyspark/dagster-snowflake-pyspark-{{ lib_version }}.tar.gz
    sha256: 3e10ce9e319bad9b39b53e639562bfe4399d0d4cd2667d22871f3a3db2f7d6c0

  - folder: dagster-spark
    url: https://pypi.io/packages/source/d/dagster-spark/dagster-spark-{{ lib_version }}.tar.gz
    sha256: eb6cd5021cc8bc1d6173dbd5560cd8858933604cc598df2bce7cd5285547f445

  - folder: dagster-ssh
    url: https://pypi.io/packages/source/d/dagster-ssh/dagster-ssh-{{ lib_version }}.tar.gz
    sha256: aff5cdbcd07c19d245f3fdef1e39c96d6d5abaa9b94d7da3a5f5927fc5a3bb16

  - folder: dagster-twilio
    url: https://pypi.io/packages/source/d/dagster-twilio/dagster-twilio-{{ lib_version }}.tar.gz
    sha256: 79b11ec1d1c51568729c5f8e281a4331cbdd30cfca023a0a2bbe9ca41b091713

  - folder: dagster-wandb
    url: https://pypi.io/packages/source/d/dagster-wandb/dagster-wandb-{{ lib_version }}.tar.gz
    sha256: 5c93b97f063f6be409c51f1dc6e1698a5a4552cfb8470de64f53d94d0f266a2a

  - folder: dagstermill
    url: https://pypi.io/packages/source/d/dagstermill/dagstermill-{{ lib_version }}.tar.gz
    sha256: 102583ea69392729a3539ce39a38ca3ae10e89849277803f5161671f63f8aa6f
  {% endif %}


build:
  noarch: python
  number: {{ epoch_build_number }}

requirements:
  host:
    - pip
    - {{ py_spec }}
  run:
    - {{ py_spec }}


test:
  commands:
    - echo "tests in outputs"


outputs:
  # all platform/python versions
  - name: dagster
    build:
      noarch: python
      version: {{ version }}
      entry_points:
        - dagster = dagster.cli:main
        - dagster-daemon = dagster.daemon.cli:main
      script: cd dagster && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - {{ py_spec }}
        - pip
      run:
        - {{ py_spec }}
        - {{ grpcio_spec }}
        - grpcio-health-checking >=1.44.0
        - alembic >=1.2.1,!=1.6.3,!=1.7.0
        - click >=5.0
        - coloredlogs >=6.1,<=14.0
        - croniter >=0.3.34
        - docstring_parser
        - jinja2
        - packaging >=20.9
        - pendulum
        - protobuf >=3.20.0
        - psutil >=1.0
        - pydantic
        - python-dateutil
        - python-dotenv
        - pytz
        - pywin32-on-windows
        - pyyaml >=5.1
        - requests
        - setuptools
        - sqlalchemy >=1.0,<2.0.0
        - tabulate
        - tomli
        - toposort >=1.0
        - tqdm
        - typing_extensions >=4.4.0
        - universal_pathlib
        - watchdog >=0.8.3
      run_constrained:
        - pywin32 !=226

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster
        - dagster.api
        - dagster.check
        - dagster.cli
        - dagster.config
        - dagster.core.definitions
        - dagster.core.events
        - dagster.core.execution
        - dagster.core.executor
        - dagster.core.host_representation
        - dagster.core.instance
        - dagster.core.launcher
        - dagster.core.run_coordinator
        - dagster.core.scheduler
        - dagster.core.selector
        - dagster.core.snap
        - dagster.core.storage
        - dagster.core.system_config
        - dagster.core.types
        - dagster.core.workspace
        - dagster.daemon
        - dagster.grpc
        - dagster.loggers
        - dagster.seven
        - dagster.utils
      commands:
        - pip check
        - dagster --help
        - dagster-daemon --help

    about:
      home: https://github.com/dagster-io/dagster
      license: Apache-2.0
      license_family: APACHE
      summary: The data orchestration platform built for productivity.
      doc_url: https://dagster.readthedocs.io
      license_file: dagster/LICENSE
      description: |
        Dagster lets you define pipelines in terms of the data flow between reusable, logical components,
        then test locally and run anywhere. With a unified view of pipelines and the assets they produce,
        Dagster can schedule and orchestrate Pandas, Spark, SQL, or anything else that Python can invoke.

        Dagster is designed for data platform engineers, data engineers, and full-stack data scientists.
        Building a data platform with Dagster makes your stakeholders more independent and your systems
        more robust. Developing data pipelines with Dagster makes testing easier and deploying faster.

  {% if build_plugins %}
  - name: dagster-graphql
    build:
      version: {{ version }}
      noarch: python
      entry_points:
        - dagster-graphql = dagster_graphql.cli:main
      script: cd dagster-graphql && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - gql-with-requests >=3.0.0
        - graphene >=3
        - python >=3.6
        - requests
        - starlette
        - urllib3 <2.0.0

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_graphql
        - dagster_graphql.client
        - dagster_graphql.schema
      commands:
        - dagster-graphql --help
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/dagster-graphql
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-graphql/LICENSE
      summary: The GraphQL frontend to python dagster.

  - name: dagster-celery
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-celery && {{ PYTHON }} -m pip install . -vv --no-deps
      entry_points:
        - dagster-celery = dagster_celery.cli:main

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - celery >=4.3.0
        - click >=5.0,<9
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
        # to get viable intersecting click ranges
        - celery >=5.1.2
      imports:
        - dagster_celery
      commands:
        - dagster-celery --help
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/blob/master/python_modules/dagster-celery
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-celery/LICENSE
      summary: Package for using Celery as Dagster's execution engine.

  - name: dagster-census
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-census && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_census
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/blob/master/python_modules/dagster-census
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-census/LICENSE
      summary: Package for integrating Census with Dagster.

  - name: dagster-celery-docker
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-celery-docker && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster-graphql", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster-celery", max_pin="x.x.x") }}
        - docker-py
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
        # to get viable intersecting click ranges
        - celery >=5.1.2
      imports:
        - dagster_celery_docker
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/blob/master/python_modules/dagster-celery-docker
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-celery-docker/LICENSE
      summary: A Dagster integration for celery-docker

  - name: dagster-celery-k8s
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-celery-k8s && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster-celery", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster-k8s", max_pin="x.x.x") }}
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
        # to get viable intersecting click ranges
        - celery >=5.1.2
      imports:
        - dagster_celery_k8s
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/blob/master/python_modules/dagster-celery-k8s
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-celery-k8s/LICENSE
      summary: A Dagster integration for celery-k8s-executor

  - name: dagster-duckdb
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-duckdb && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python-duckdb
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_duckdb
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/blob/master/python_modules/dagster-duckdb
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-duckdb/LICENSE
      summary: Package for DuckDB-specific Dagster framework op and resource components.

  - name: dagster-duckdb-pandas
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-duckdb-pandas && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster-duckdb", max_pin="x.x.x") }}
        - pandas <2
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_duckdb_pandas
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/blob/master/python_modules/dagster-duckdb-pandas
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-duckdb-pandas/LICENSE
      summary: Package for storing Pandas DataFrames in DuckDB.

  - name: dagster-duckdb-polars
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-duckdb-polars && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster-duckdb", max_pin="x.x.x") }}
        # TODO: get polars-with-X outputs
        - polars
        - pyarrow >=4.0.0
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_duckdb_polars
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/blob/master/python_modules/dagster-duckdb-polars
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-duckdb-polars/LICENSE
      summary: Package for storing Polars DataFrames in DuckDB.

  - name: dagster-duckdb-pyspark
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-duckdb-pyspark && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster-duckdb", max_pin="x.x.x") }}
        - pandas <2
        - pyspark >=2.0.2
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_duckdb_pyspark
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/blob/master/python_modules/dagster-duckdb-pyspark
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-duckdb-pyspark/LICENSE
      summary: Package for storing PySpark DataFrames in DuckDB.

  - name: dagster-k8s
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-k8s && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python-kubernetes
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_k8s
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-k8s
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-k8s/LICENSE
      summary: A Dagster integration for k8s

  - name: dagster-pyspark
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-pyspark && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster-spark", max_pin="x.x.x") }}
        - pyspark
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_pyspark
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-pyspark
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-pyspark/LICENSE
      summary: Package for PySpark Dagster framework components.

  - name: dagster-spark
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-spark && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_spark
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-spark
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-spark/LICENSE
      summary: Package for Spark Dagster framework components.

  - name: dagster-airbyte
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-airbyte && {{ PYTHON }} -m pip install . -vv --no-deps
      entry_points:
        - dagster-airbyte = dagster_airbyte.cli:main

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - requests

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_airbyte
      commands:
        - pip check
        - dagster-airbyte --help

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/dagster-airbyte
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-airbyte/LICENSE
      summary: Package for integrating Airbyte with Dagster.

  # issues with python 3.8
  - name: dagster-airflow
    build:
      noarch: python
      version: {{ lib_version }}
      script:
        # TODO: remove after https://github.com/dagster-io/dagster/pull/9932
        - {{ PYTHON }} -c '__import__("pathlib").Path("dagster-airflow/dagster_airflow/hooks/__init__.py").touch()'
        - {{ PYTHON }} -c '__import__("pathlib").Path("dagster-airflow/dagster_airflow/links/__init__.py").touch()'
        - cd dagster-airflow && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - docker-py >=5.0.3,<6
        - lazy-object-proxy
        - pendulum
        - python >=3.6
        - python-dateutil >=2.8.0

    test:
      requires:
        - {{ py_spec }}
        - pip
        - apache-airflow-providers-docker
        - jinja2 <3
        # TODO: remove after https://github.com/conda-forge/airflow-feedstock/pull/92
        - pathspec >=0.9.0,<0.10.0
      imports:
        - dagster_airflow
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/dagster-airflow
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-airflow/LICENSE
      summary: Airflow plugin for Dagster

  - name: dagit
    build:
      noarch: python
      version: {{ version }}
      entry_points:
        - dagit = dagit.cli:main
        - dagit-debug = dagit.debug:main
      script: cd dagit && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster-graphql", max_pin="x.x.x") }}
        - click >=7.0,<9.0
        - starlette
        - uvicorn-standard

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagit
        - dagit.schema
        - dagit.templates
      commands:
        - pip check
        - dagit --help

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/dagit
      license: Apache-2.0
      license_family: APACHE
      license_file: dagit/LICENSE
      summary: Dagster UI

  - name: dagster-dbt
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-dbt && {{ PYTHON }} -m pip install . -vv --no-deps
      entry_points:
        - dagster-dbt-cloud = dagster_dbt.cloud.cli:app

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - dbt-core <1.6
        - networkx
        - python >=3.6
        - requests
        - typer

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_dbt
      commands:
        - pip check
        - dagster-dbt-cloud --help

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/dagster-dbt
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster/LICENSE
      summary: A Dagster integration for dbt

  - name: dagster-fivetran
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-fivetran && {{ PYTHON }} -m pip install . -vv --no-deps
      entry_points:
        - dagster-fivetran = dagster_fivetran.cli:main

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python >=3.6
        - requests

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_fivetran
      commands:
        - pip check
        - dagster-fivetran --help

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-fivetran
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-fivetran/LICENSE
      summary: Package for integrating Fivetran with Dagster.

  - name: dagster-ge
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-ge && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster-pandas", max_pin="x.x.x") }}
        - dataclasses
        - great-expectations >=0.11.9,!=0.12.8,!=0.13.17,!=0.13.27
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_ge
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-ge
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-ge/LICENSE
      summary: Package for GE-specific Dagster framework solid and resource components.

  - name: dagster-github
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-github && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - cryptography >=1.4
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - pyjwt
        - python >=3.6
        - requests

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_github
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-github
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-github/LICENSE
      summary: Github plugin for Dagster

  - name: dagster-docker
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-docker && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - docker-py
        - docker-image-py
        - python >=3.6
        - urllib3 <2

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_docker
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-docker
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-docker/LICENSE
      summary: A Dagster integration for docker

  - name: dagster-gcp
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-gcp && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster-pandas", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - db-dtypes
        # TODO: hopefully remove after https://github.com/conda-forge/googleapis-common-protos-feedstock/issues/50
        - googleapis-common-protos !=1.57.0=*_1
        - google-api-python-client
        - google-cloud-bigquery-core
        - google-cloud-storage
        - oauth2client
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_gcp
        - dagster_gcp.bigquery
        - dagster_gcp.dataproc
        - dagster_gcp.gcs
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-gcp
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-gcp/LICENSE
      summary: Package for GCP-specific Dagster framework solid and resource components.

  - name: dagster-gcp-pandas
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-gcp-pandas && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster-gcp", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - pandas <2
    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_gcp_pandas
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-gcp-pandas
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-gcp-pandas/LICENSE
      summary: Package for storing Pandas DataFrames in GCP.

  - name: dagster-gcp-pyspark
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-gcp-pyspark && {{ PYTHON }} -m pip install . -vv --no-deps
    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster-gcp", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - pyspark
    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_gcp_pyspark
      commands:
        - pip check
    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-gcp-pyspark
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-gcp-pyspark/LICENSE
      summary: Package for storing PySpark DataFrames in GCP

  - name: dagster-mlflow
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-mlflow && {{ PYTHON }} -m pip install . -vv --no-deps
    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - mlflow
        - pandas
        - python >=3.6
    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_mlflow
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-mlflow
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-mlflow/LICENSE
      summary: Package for mlflow Dagster framework components

  - name: dagster-managed-elements
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-managed-elements && {{ PYTHON }} -m pip install . -vv --no-deps
      entry_points:
        - dagster-managed-elements = dagster_managed_elements.cli:main
        - dagster-me = dagster_managed_elements.cli:main
    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - click-spinner
        - requests
    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_managed_elements
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-managed-elements
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-managed-elements/LICENSE
      summary: Package for Managed elements with Dagster.

  - name: dagster-pandas
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-pandas && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - pandas
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_pandas
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-pandas/LICENSE
      summary: Utilities and examples for working with pandas and dagster, an opinionated framework for expressing data pipelines

  - name: dagster-mysql
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-mysql && {{ PYTHON }} -m pip install . -vv --no-deps
    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - mysql-connector-python
        - python >=3.6
    test:
      requires:
        - {{ py_spec }}
        # - pip
        # TODO: can't be installed, investigate upstream
        # #https://github.com/conda-forge/mysql-connector-python-feedstock/pull/77
        # - protobuf >=3.11.0,<=3.20.1
      imports:
        - dagster_mysql
      # commands:
      #   - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-mysql
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-mysql/LICENSE
      summary: A Dagster integration for MySQL

  - name: dagster-msteams
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-msteams && {{ PYTHON }} -m pip install . -vv --no-deps
    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python >=3.6
        - requests >=2,<3
    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_msteams
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-msteams
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-msteams/LICENSE
      summary: A Microsoft Teams client resource for posting to Microsoft Teams

  - name: dagster-pagerduty
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-pagerduty && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - pypd
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_pagerduty
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-pagerduty
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-pagerduty/LICENSE
      summary: Package for pagerduty Dagster framework components.

  - name: dagster-papertrail
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-papertrail && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_papertrail
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-papertrail
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-papertrail/LICENSE
      summary: Package for papertrail Dagster framework components.

  - name: dagster-postgres
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-postgres && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - psycopg2-binary
        - python >=3.6

    test:
      imports:
        - dagster_postgres
      commands:
        - pip check
      requires:
        - {{ py_spec }}
        - pip

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-postgres
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-postgres/LICENSE
      summary: A Dagster integration for postgres

  - name: dagster-prometheus
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-prometheus && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - prometheus_client
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_prometheus
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-prometheus
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-prometheus/LICENSE
      summary: A Dagster integration for prometheus

  - name: dagster-slack
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-slack && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python >=3.6
        - slack-sdk

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_slack
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-slack
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-slack/LICENSE
      summary: A Slack client resource for posting to Slack

  - name: dagster-ssh
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-ssh && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - paramiko
        - python >=3.6
        - sshtunnel

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_ssh
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-ssh
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-ssh/LICENSE
      summary: Package for ssh Dagster framework components.

  - name: dagster-twilio
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-twilio && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python >=3.6
        - twilio

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_twilio
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-twilio
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-twilio/LICENSE
      summary: A Dagster integration for twilio

  - name: dagster-aws
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-aws && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - boto3
        - packaging
        - python >=3.6
        - requests

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_aws
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/dagster-aws
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-aws/LICENSE
      summary: Package for AWS-specific Dagster framework solid and resource components.

  - name: dagster-dask
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-dask && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - bokeh
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - dask >=1.2.2
        - distributed >=1.28.1
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_dask
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/dagster-dask
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-dask/LICENSE
      summary: Package for using Dask as Dagster's execution engine.

  - name: dagster-datadog
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-datadog && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - datadog
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_datadog
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-datadog
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-datadog/LICENSE
      summary: Package for datadog Dagster framework components.

  - name: dagster-pandera
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-pandera && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.7
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - pandas
        - pandera >=0.14.2
        - python >=3.7

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_pandera
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-pandera
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-pandera/LICENSE
      summary: Integration layer for dagster and pandera.

  - name: dagster-shell
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-shell && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python >=3.6

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_shell
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-shell
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-shell/LICENSE
      summary: Package for Dagster shell ops.

  - name: dagster-snowflake
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-snowflake && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - python >=3.6
        - snowflake-connector-python >=2.1.0
        # currently an extra, but always imported: see https://github.com/dagster-io/dagster/pull/6984
        - pandas

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_snowflake
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-snowflake
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-snowflake/LICENSE
      summary: Package for Snowflake Dagster framework components.

  - name: dagster-snowflake-pandas
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-snowflake-pandas && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster-snowflake", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - pandas
        - python >=3.6
        - requests
        - snowflake-connector-python
        - snowflake-sqlalchemy >=1.2
        - sqlalchemy !=1.4.42
    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_snowflake_pandas
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-snowflake-pandas
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-snowflake-pandas/LICENSE
      summary: Package for integrating Snowflake and Pandas with Dagster.

  - name: dagster-snowflake-pyspark
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-snowflake-pyspark && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.7
      run:
        - {{ pin_subpackage("dagster-snowflake", max_pin="x.x.x") }}
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - pyspark
        - python >=3.7
        - requests
        - snowflake-sqlalchemy
    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_snowflake_pyspark
      commands:
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-snowflake-pyspark
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-snowflake-pyspark/LICENSE
      summary: Package for integrating Snowflake and PySpark with Dagster.

  - name: dagstermill
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagstermill && {{ PYTHON }} -m pip install . -vv --no-deps
      entry_points:
        - dagstermill = dagstermill.cli:main

    requirements:
      host:
        - pip
        - python >=3.6
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - ipykernel >=4.9.0,!=5.4.0,!=5.4.1
        - ipython_genutils >=0.2.0
        - jupyter_client <8
        - nbconvert
        - packaging >=20.9
        - papermill >=1.0.0
        - python >=3.6
        - scrapbook >=0.5

    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagstermill
      commands:
        - dagstermill --help
        - pip check

    about:
      home: https://github.com/dagster-io/dagster/tree/master/python_modules/dagstermill
      license: Apache-2.0
      license_family: APACHE
      license_file: dagstermill/LICENSE
      summary: A Dagster integration for papermill

  - name: dagster-wandb
    build:
      noarch: python
      version: {{ lib_version }}
      script: cd dagster-wandb && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3.7
      run:
        - {{ pin_subpackage("dagster", max_pin="x.x.x") }}
        - wandb >=0.13.5
    test:
      requires:
        - {{ py_spec }}
        - pip
      imports:
        - dagster_wandb
      commands:
        - pip check

  {% endif %}

about:
  home: https://github.com/dagster-io
  summary: The data orchestration platform built for productivity.
  license: Apache-2.0
  license_family: APACHE
  license_file: dagster/LICENSE
  doc_url: https://dagster.readthedocs.io
  description: >-
    Dagster is a system for building modern data applications. Combining an elegant programming model and beautiful tools, Dagster allows infrastructure engineers, data engineers, and data scientists to seamlessly collaborate to process and produce the trusted, reliable data needed in today's world.

extra:
  feedstock-name: dagster
  recipe-maintainers:
    - xhochy
    - bollwyvl
    - mgasner
